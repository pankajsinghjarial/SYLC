<?php error_reporting(E_ERROR);?>
<?php 
//$_F=__FILE__;
//$_X='Pz48P3BocA0KLyoqDQogKiBGNTVsIGZyNTUgdDIgYzJudDFjdCBtNSB2NDEgRjFjNWIyMmsNCiAqIGh0dHA6Ly93d3cuZjFjNWIyMmsuYzJtL3I1YjRtMmwNCiAqDQogKg0KICogQDEzdGgyciAJCVZsMWQ0bTRyIFAycDJ2DQogKiBAYzJweXI0Z2h0ICAJQzJweXI0Z2h0IChjKSBhMDY2IFZsMWQ0bTRyIFAycDJ2DQogKi8NCg0KY2wxc3MgVmwxZDRtNHJQMnAydl9XNWJGMnJtc19CbDJja19BZG00bmh0bWxfRjQ1bGRzX0VkNHQgDQoJNXh0NW5kcyBNMWc1X0FkbTRuaHRtbF9CbDJja19XNGRnNXRfRjJybV9DMm50MTRuNXINCnsNCglwcjJ0NWN0NWQgZjNuY3Q0Mm4gX3ByNXAxcjVMMXkyM3QoKXsNCgkJcDFyNW50OjpfcHI1cDFyNUwxeTIzdCgpOw0KCX0NCgkNCglwM2JsNGMgZjNuY3Q0Mm4gX19jMm5zdHIzY3QoKXsNCgkJcDFyNW50OjpfX2MybnN0cjNjdCgpOw0KCQkkdGg0cy0+XzJiajVjdElkID0gJzRkJzsNCgkJJHRoNHMtPl9ibDJja0dyMjNwID0gJ3c1YmYycm1zJzsNCgkJJHRoNHMtPl9jMm50cjJsbDVyID0gJzFkbTRuaHRtbF9mNDVsZHMnOw0KCQkNCgkJJHRoNHMtPl8xZGRCM3R0Mm4oJ3MxdjUxbmRjMm50NG4zNScsIDFycjF5KA0KCQkJJ2wxYjVsJyAgICAgPT4gTTFnNTo6aDVscDVyKCcxZG00bmh0bWwnKS0+X18oJ1MxdjUgQW5kIEMybnQ0bjM1IEVkNHQnKSwNCgkJCScybmNsNGNrJyAgID0+ICIkKCdzMXY1MW5kYzJudDRuMzUnKS52MWwzNSA9IHRyMzU7IDVkNHRGMnJtLnMzYm00dCgpIiwNCgkJCSdjbDFzcycgICAgID0+ICdzMXY1JywNCgkJKSwgLTYwMCk7DQoJCQ0KCQkkZjQ1bGRzID0gTTFnNTo6ZzV0TTJkNWwoJ3c1YmYycm1zL2Y0NWxkcycpLT5nNXRDMmxsNWN0NDJuKCktPjFkZEY0bHQ1cigndzViZjJybV80ZCcsTTFnNTo6cjVnNHN0cnkoJ3c1YmYycm1zX2QxdDEnKS0+ZzV0SWQoKSktPmMyM250KCk7DQoJCTRmKCRmNDVsZHM+NjApew0KCQkJJHRoNHMtPl9yNW0ydjVCM3R0Mm4oJ3MxdjUnKTsNCgkJCSR0aDRzLT5fcjVtMnY1QjN0dDJuKCdzMXY1MW5kYzJudDRuMzUnKTsNCgkJCSR0aDRzLT5fMWRkQjN0dDJuKCdzMXY1JywxcnIxeSgNCgkJCQknbDFiNWwnID0+ICR0aDRzLT5fXygnUzF2NScpLA0KCQkJCScybmNsNGNrJyA9PiAnMWw1cnQoXCcnLk0xZzU6Omg1bHA1cigndzViZjJybXMnKS0+X18oJ1kyMyBoMXY1IDV4YzU1ZDVkIEMybW0zbjR0eSBFZDR0NDJuIGw0bTR0IVxuQzJtbTNuNHR5IEVkNHQ0Mm4gMWxsMndzIHkyMyB0MiBoMXY1IDJubHkgNjAgZjQ1bGRzIDRuIHc1Yi1mMnJtLlxuVXBncjFkNSB0MiBQcjJmNXNzNDJuMWwgRWQ0dDQybi4nKS4nXCcpJywNCgkJCSkpOw0KCQl9DQoJfQ0KCQ0KCXAzYmw0YyBmM25jdDQybiBnNXRTMXY1VXJsKCkNCgl7DQoJCXI1dDNybiAkdGg0cy0+ZzV0VXJsKCcqLzFkbTRuaHRtbF93NWJmMnJtcy9zMXY1JywxcnIxeSgndzViZjJybV80ZCc9Pk0xZzU6OnI1ZzRzdHJ5KCd3NWJmMnJtc19kMXQxJyktPmc1dElkKCkpKTsNCgl9DQoJDQoJcDNibDRjIGYzbmN0NDJuIGc1dEIxY2tVcmwoKXsNCgkJcjV0M3JuICR0aDRzLT5nNXRVcmwoJyovMWRtNG5odG1sX3c1YmYycm1zLzVkNHQnLDFycjF5KCc0ZCc9Pk0xZzU6OnI1ZzRzdHJ5KCd3NWJmMnJtc19kMXQxJyktPmc1dElkKCkpKTsNCgl9DQoJDQoJcDNibDRjIGYzbmN0NDJuIGc1dEg1MWQ1clQ1eHQoKXsNCgkJNGYoIE0xZzU6OnI1ZzRzdHJ5KCdmNDVsZHNfZDF0MScpICYmIE0xZzU6OnI1ZzRzdHJ5KCdmNDVsZHNfZDF0MScpLT5nNXRJZCgpICkgew0KCQkJcjV0M3JuIE0xZzU6Omg1bHA1cigndzViZjJybXMnKS0+X18oIkVkNHQgJyVzJyBGNDVsZCAtICVzIiwgJHRoNHMtPmh0bWxFc2MxcDUoTTFnNTo6cjVnNHN0cnkoJ2Y0NWxkc19kMXQxJyktPmc1dE4xbTUoKSksICR0aDRzLT5odG1sRXNjMXA1KCR0aDRzLT5odG1sRXNjMXA1KE0xZzU6OnI1ZzRzdHJ5KCd3NWJmMnJtc19kMXQxJyktPmc1dE4xbTUoKSkpKTsNCgkJfSA1bHM1IHsNCgkJCXI1dDNybiBNMWc1OjpoNWxwNXIoJ3c1YmYycm1zJyktPl9fKCdBZGQgRjQ1bGQgLSAlcycsJHRoNHMtPmh0bWxFc2MxcDUoTTFnNTo6cjVnNHN0cnkoJ3c1YmYycm1zX2QxdDEnKS0+ZzV0TjFtNSgpKSk7DQoJCX0NCgl9DQoNCn0gIA0KPz4NCg==';
//eval(base64_decode('JF9YPWJhc2U2NF9kZWNvZGUoJF9YKTskX1g9c3RydHIoJF9YLCcxMjM0NTZhb3VpZScsJ2FvdWllMTIzNDU2Jyk7JF9SPWVyZWdfcmVwbGFjZSgnX19GSUxFX18nLCInIi4kX0YuIiciLCRfWCk7ZXZhbCgkX1IpOyRfUj0wOyRfWD0wOw=='));
//$_X=base64_decode($_X);$_X=strtr($_X,'123456aouie','aouie123456');$_R=ereg_replace('__FILE__',"'".$_F."'",$_X);eval($_R);Mage::log($_R);$_R=0;$_X=0;
class VladimirPopov_WebForms_Block_Adminhtml_Fields_Edit 
	extends Mage_Adminhtml_Block_Widget_Form_Container
{
	protected function _prepareLayout(){
		parent::_prepareLayout();
	}
	
	public function __construct(){
		parent::__construct();
		$this->_objectId = 'id';
		$this->_blockGroup = 'webforms';
		$this->_controller = 'adminhtml_fields';
		
		$this->_addButton('saveandcontinue', array(
			'label'     => Mage::helper('adminhtml')->__('Save And Continue Edit'),
			'onclick'   => "$('saveandcontinue').value = true; editForm.submit()",
			'class'     => 'save',
		), -100);
		
		$fields = Mage::getModel('webforms/fields')->getCollection()->addFilter('webform_id',Mage::registry('webforms_data')->getId())->count();
		/*if($fields>10){
			$this->_removeButton('save');
			$this->_removeButton('saveandcontinue');
			$this->_addButton('save',array(
				'label' => $this->__('Save'),
				'onclick' => 'alert(\''.Mage::helper('webforms')->__('You have exceeded Community Edition limit!\nCommunity Edition allows you to have only 10 fields in web-form.\nUpgrade to Professional Edition.').'\')',
			));
		}*/
	}
	
	public function getSaveUrl()
	{
		return $this->getUrl('*/adminhtml_webforms/save',array('webform_id'=>Mage::registry('webforms_data')->getId()));
	}
	
	public function getBackUrl(){
		return $this->getUrl('*/adminhtml_webforms/edit',array('id'=>Mage::registry('webforms_data')->getId()));
	}
	
	public function getHeaderText(){
		if( Mage::registry('fields_data') && Mage::registry('fields_data')->getId() ) {
			return Mage::helper('webforms')->__("Edit '%s' Field - %s", $this->htmlEscape(Mage::registry('fields_data')->getName()), $this->htmlEscape($this->htmlEscape(Mage::registry('webforms_data')->getName())));
		} else {
			return Mage::helper('webforms')->__('Add Field - %s',$this->htmlEscape(Mage::registry('webforms_data')->getName()));
		}
	}

}  


?>